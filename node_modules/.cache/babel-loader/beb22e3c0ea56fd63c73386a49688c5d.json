{"ast":null,"code":"Object.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nvar React = require('react');\n\nvar renderprops_cjs = require('react-spring/renderprops.cjs');\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\n\n\nvar __assign = function () {\n  __assign = Object.assign || function __assign(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nfunction __rest(s, e) {\n  var t = {};\n\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n} // Keeps track of whether this is the first time render since the component was mounted.\n// shamelessly taken from https://github.com/streamich/react-use\n\n\nfunction useFirstMount() {\n  var isFirst = React.useRef(true);\n\n  if (isFirst.current) {\n    isFirst.current = false;\n    return true;\n  }\n\n  return isFirst.current;\n}\n\nvar Accordion = function (_a) {\n  var _b = _a.className,\n      className = _b === void 0 ? '' : _b,\n      children = _a.children,\n      _c = _a.toggled,\n      toggled = _c === void 0 ? false : _c,\n      onFullyShown = _a.onFullyShown,\n      onFullyHidden = _a.onFullyHidden,\n      props = __rest(_a, [\"className\", \"children\", \"toggled\", \"onFullyShown\", \"onFullyHidden\"]);\n\n  var isFirstMount = useFirstMount();\n  var handleAnimationRest = React.useCallback(function () {\n    if (toggled && onFullyShown) onFullyShown();else if (!toggled && onFullyHidden) onFullyHidden();\n  }, [toggled, onFullyShown, onFullyHidden]);\n  var cssClass = [\"image-tooltips-item__content\", className];\n  return React.createElement(renderprops_cjs.Spring, {\n    config: {\n      tension: 170,\n      friction: 22,\n      clamp: true\n    },\n    from: {\n      height: 0\n    },\n    to: {\n      height: toggled ? 'auto' : 0\n    },\n    immediate: isFirstMount,\n    onRest: handleAnimationRest\n  }, function (styleProps) {\n    return React.createElement(\"div\", __assign({\n      className: cssClass.join(' '),\n      style: styleProps\n    }, props), children);\n  });\n};\n\nvar ImageTooltipsTrigger = function (_a) {\n  var className = _a.className,\n      children = _a.children,\n      props = __rest(_a, [\"className\", \"children\"]);\n\n  var cssClass = [\"image-tooltips-item__trigger\", className];\n  return React.createElement(\"div\", __assign({\n    className: cssClass.join(' ')\n  }, props, {\n    tabIndex: 0\n  }), children);\n};\n\nvar ImageTooltipsItem = function () {\n  return React.createElement(\"div\", null);\n};\n\nvar _ImageTooltipsItem = function (_a) {\n  var children = _a.children,\n      dataId = _a.dataId,\n      top = _a.top,\n      left = _a.left,\n      imageSize = _a.imageSize,\n      toggled = _a.toggled,\n      trigger = _a.trigger,\n      props = __rest(_a, [\"children\", \"dataId\", \"top\", \"left\", \"imageSize\", \"toggled\", \"trigger\"]);\n\n  var cssClass = ['image-tooltips-item'];\n\n  if (toggled) {\n    cssClass.push('toggled');\n  } // Validation of tooltip coordinates\n\n\n  var validateCoord = function (c, max) {\n    if (c <= 0) {\n      console.log(\"Tooltip with id \" + dataId + \" has coordinate outside of image.\");\n      return 1;\n    }\n\n    if (c > max) {\n      console.log(\"Tooltip with id \" + dataId + \" has coordinate outside of image.\");\n      return max;\n    }\n\n    return c;\n  };\n\n  left = validateCoord(left, imageSize.initW);\n  top = validateCoord(top, imageSize.initH); // Calculate tooltip position based on image scaling\n\n  var style = {\n    left: Math.round(left * imageSize.curW / imageSize.initW) + \"px\",\n    top: Math.round(top * imageSize.curH / imageSize.initH) + \"px\"\n  };\n  return React.createElement(\"div\", {\n    className: cssClass.join(' '),\n    style: style,\n    \"data-id\": dataId\n  }, trigger ? React.createElement(ImageTooltipsTrigger, __assign({}, trigger.props), trigger.props.children) : React.createElement(ImageTooltipsTrigger, null, \"+\"), React.createElement(Accordion, __assign({\n    toggled: toggled\n  }, props), children));\n};\n\nvar ImageTooltips = function (_a) {\n  var children = _a.children,\n      width = _a.width,\n      height = _a.height,\n      _b = _a.triggerEvent,\n      triggerEvent = _b === void 0 ? 'click' : _b,\n      props = __rest(_a, [\"children\", \"width\", \"height\", \"triggerEvent\"]);\n\n  var _c = React.useState({\n    imageSize: null,\n    toggled: null\n  }),\n      state = _c[0],\n      _setState = _c[1];\n\n  var stateRef = React.useRef(state);\n  var imageEl = React.useRef(null);\n  var divEl = React.useRef(null); // Need to use Ref because state is unavailable in event listeners\n\n  var setImageSize = function (imageSize) {\n    stateRef.current.imageSize = imageSize;\n\n    _setState(__assign({}, state, {\n      imageSize: imageSize\n    }));\n  };\n\n  var setToggled = function (toggled) {\n    stateRef.current.toggled = toggled;\n\n    _setState(__assign({}, state, {\n      toggled: toggled\n    }));\n  };\n\n  var timerId;\n  React.useEffect(function () {\n    // Listener that handles resize with simple throttling\n    var handleResize = function () {\n      if (timerId) {\n        return;\n      }\n\n      timerId = global.setTimeout(function () {\n        setImageSize({\n          initW: stateRef.current.imageSize.initW,\n          initH: stateRef.current.imageSize.initH,\n          curW: imageEl.current.offsetWidth,\n          curH: imageEl.current.offsetHeight\n        });\n        timerId = undefined;\n      }, 200);\n    };\n\n    window.addEventListener('resize', handleResize);\n    return function () {\n      return window.removeEventListener('resize', handleResize);\n    };\n  }, []); // Add event handler for all tooltip items\n\n  React.useEffect(function () {\n    var startHandler = function (event) {\n      var clicked = event.target;\n\n      if (clicked.classList.contains('image-tooltips-item__trigger')) {\n        var dataIdStr = clicked.parentElement.getAttribute('data-id');\n\n        if (dataIdStr) {\n          var dataId = parseInt(dataIdStr);\n          setToggled(stateRef.current.toggled != dataId ? dataId : null);\n        } else {\n          setToggled(null);\n        }\n      }\n    };\n\n    var endHandler = function () {\n      setToggled(null);\n    };\n\n    divEl.current.addEventListener(triggerEvent, startHandler);\n\n    if (triggerEvent == 'mouseover') {\n      divEl.current.addEventListener('mouseout', endHandler);\n    }\n\n    return function () {\n      divEl.current.removeEventListener(triggerEvent, startHandler);\n\n      if (triggerEvent == 'mouseover') {\n        divEl.current.removeEventListener('mouseout', endHandler);\n      }\n    };\n  }, []); // Making image responsive\n\n  var style = {\n    maxWidth: width + \"px\"\n  };\n  return React.createElement(\"div\", {\n    ref: divEl,\n    className: \"image-tooltips\",\n    style: style\n  }, React.createElement(\"img\", __assign({\n    ref: imageEl\n  }, props, {\n    onLoad: function () {\n      return setImageSize({\n        // Set initial image dimensions in state\n        initW: width,\n        initH: height,\n        curW: imageEl.current.offsetWidth,\n        curH: imageEl.current.offsetHeight\n      });\n    }\n  })), state.imageSize && children && React.Children.map(children, function (child, index) {\n    if (!child || !React.isValidElement(child)) {\n      return child;\n    }\n\n    var childEl = child;\n    return React.createElement(_ImageTooltipsItem, __assign({\n      key: index,\n      dataId: index,\n      toggled: index === state.toggled,\n      imageSize: state.imageSize\n    }, childEl.props), childEl.props.children);\n  }));\n};\n\nexports.ImageTooltips = ImageTooltips;\nexports.ImageTooltipsItem = ImageTooltipsItem;\nexports.ImageTooltipsTrigger = ImageTooltipsTrigger;","map":{"version":3,"sources":["../src/hooks/firstmount.tsx","../src/Accordion.tsx","../src/ImageTooltipsTrigger.tsx","../src/ImageTooltipsItem.tsx","../src/ImageTooltips.tsx"],"names":["useRef","React.useCallback","React.createElement","Spring","React.useRef","React.useEffect","React.Children","React.isValidElement"],"mappings":"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","sourcesContent":["import { useRef } from 'react';\n\n// Keeps track of whether this is the first time render since the component was mounted.\n// shamelessly taken from https://github.com/streamich/react-use\nexport default function useFirstMount() {\n  const isFirst = useRef(true);\n\n  if (isFirst.current) {\n    isFirst.current = false;\n\n    return true;\n  }\n\n  return isFirst.current;\n}\n","import * as React from 'react';\r\nimport { Spring } from 'react-spring/renderprops.cjs';\r\nimport useFirstMount from './hooks/firstmount';\r\n\r\nexport interface AccordionProps extends React.ComponentPropsWithoutRef<\"div\"> {\r\n  className?: string;\r\n  children?: React.ReactNode;\r\n  toggled?: boolean;\r\n  onFullyShown?: () => void;\r\n  onFullyHidden?: () => void;\r\n}\r\n\r\nexport const Accordion: React.FC<AccordionProps> =({\r\n  className = '',\r\n  children,\r\n  toggled = false,\r\n  onFullyShown,\r\n  onFullyHidden,\r\n  ...props\r\n}: AccordionProps) => {\r\n  const isFirstMount = useFirstMount();\r\n\r\n  const handleAnimationRest = React.useCallback(() => {\r\n    if (toggled && onFullyShown) onFullyShown();\r\n    else if (!toggled && onFullyHidden) onFullyHidden();\r\n  }, [toggled, onFullyShown, onFullyHidden]);\r\n\r\n  const cssClass = [\"image-tooltips-item__content\", className];\r\n\r\n  return (\r\n    <Spring\r\n      config={{\r\n        tension: 170,\r\n        friction: 22,\r\n        clamp: true\r\n      }}\r\n      from={{ height: 0 }}\r\n      to={{ height: toggled ? 'auto' : 0 }}\r\n      immediate={isFirstMount}\r\n      onRest={handleAnimationRest}\r\n    >\r\n      {styleProps => (\r\n        <div className={cssClass.join(' ')} style={styleProps} {...props}>\r\n          {children}\r\n        </div>\r\n      )}\r\n    </Spring>\r\n  );\r\n}\r\n","import * as React from 'react';\r\n\r\nexport interface ImageTooltipsTriggerProps extends React.ComponentPropsWithoutRef<\"div\"> {\r\n  className?: string;\r\n  children: React.ReactNode;\r\n}\r\n\r\nexport const ImageTooltipsTrigger: React.FC<ImageTooltipsTriggerProps> = ({\r\n  className, children, ...props\r\n}: ImageTooltipsTriggerProps) => {\r\n  const cssClass = [\"image-tooltips-item__trigger\", className];\r\n  return (\r\n    <div className={cssClass.join(' ')} {...props} tabIndex={0}>\r\n      {children}\r\n    </div>\r\n  );\r\n}","import * as React from 'react';\r\nimport {Accordion} from './Accordion';\r\nimport {ImageTooltipsTrigger} from './ImageTooltipsTrigger';\r\nimport {imageSizeObject} from './ImageTooltips';\r\n\r\nexport interface ImageTooltipsItemProps extends React.ComponentPropsWithoutRef<\"div\"> {\r\n  top: number;\r\n  left: number;\r\n  trigger?: ReturnType<typeof ImageTooltipsTrigger>\r\n}\r\n\r\nexport const ImageTooltipsItem: React.FC<ImageTooltipsItemProps> = () => {\r\n  return <div></div>;\r\n};\r\n\r\nexport interface _ImageTooltipsItemProps extends ImageTooltipsItemProps {\r\n  dataId: number;\r\n  imageSize: imageSizeObject;\r\n  toggled: boolean;\r\n  children?: React.ReactNode;\r\n}\r\n\r\nexport const _ImageTooltipsItem: React.FC<_ImageTooltipsItemProps> = ({\r\n  children,\r\n  dataId,\r\n  top,\r\n  left,\r\n  imageSize,\r\n  toggled,\r\n  trigger,\r\n  ...props\r\n}: _ImageTooltipsItemProps) => {\r\n  const cssClass = ['image-tooltips-item'];\r\n  if (toggled) {\r\n    cssClass.push('toggled');\r\n  }\r\n\r\n  // Validation of tooltip coordinates\r\n  const validateCoord = (c: number, max: number) => {\r\n    if (c <= 0) {\r\n      console.log(`Tooltip with id ${dataId} has coordinate outside of image.`);\r\n      return 1;\r\n    }\r\n    if (c > max) {\r\n      console.log(`Tooltip with id ${dataId} has coordinate outside of image.`);\r\n      return max;\r\n    }\r\n    return c;\r\n  }\r\n  left = validateCoord(left, imageSize.initW);\r\n  top = validateCoord(top, imageSize.initH);\r\n\r\n  // Calculate tooltip position based on image scaling\r\n  const style = {\r\n    left: `${Math.round(left * imageSize.curW / imageSize.initW)}px`,\r\n    top: `${Math.round(top * imageSize.curH / imageSize.initH)}px`\r\n  };\r\n\r\n  return (\r\n    <div className={cssClass.join(' ')} style={style} data-id={dataId}>\r\n      {trigger ? (<ImageTooltipsTrigger {...trigger.props}>\r\n        {trigger.props.children}\r\n      </ImageTooltipsTrigger>) : (<ImageTooltipsTrigger>\r\n        +\r\n      </ImageTooltipsTrigger>\r\n      )}\r\n      <Accordion toggled={toggled} {...props}>\r\n        {children}\r\n      </Accordion>\r\n    </div>\r\n  );\r\n}\r\n","import * as React from 'react';\r\nimport {_ImageTooltipsItem, ImageTooltipsItemProps} from './ImageTooltipsItem';\r\n\r\nexport type ImageTooltipsTriggerEvent = ('click' | 'mouseover');\r\n\r\nexport interface ImageTooltipsProps extends React.ComponentPropsWithoutRef<\"img\"> {\r\n  width: number;\r\n  height: number;\r\n  triggerEvent?: ImageTooltipsTriggerEvent;\r\n  children: React.ReactNode\r\n}\r\n\r\nexport interface imageSizeObject {\r\n  initW: number;\r\n  initH: number;\r\n  curW: number;\r\n  curH: number\r\n}\r\n\r\ntype State = {\r\n  imageSize: (imageSizeObject | null),\r\n  toggled: (number | null)\r\n};\r\n\r\nexport const ImageTooltips: React.FC<ImageTooltipsProps> = ({\r\n  children,\r\n  width,\r\n  height,\r\n  triggerEvent = 'click',\r\n  ...props\r\n}: ImageTooltipsProps) => {\r\n  const [state, _setState] = React.useState<State>({imageSize: null, toggled: null});\r\n  const stateRef = React.useRef<State>(state);\r\n  const imageEl = React.useRef<HTMLImageElement | null>(null);\r\n  const divEl = React.useRef<HTMLDivElement | null>(null);\r\n\r\n  // Need to use Ref because state is unavailable in event listeners\r\n  const setImageSize = (imageSize: imageSizeObject) => {\r\n    stateRef.current.imageSize = imageSize;\r\n    _setState({...state, imageSize: imageSize});\r\n  };\r\n  const setToggled = (toggled: (number | null)) => {\r\n    stateRef.current.toggled = toggled;\r\n    _setState({...state, toggled: toggled});\r\n  };\r\n\r\n  let timerId: NodeJS.Timeout | undefined;\r\n  React.useEffect(() => {\r\n    // Listener that handles resize with simple throttling\r\n    const handleResize = () => {\r\n      if (timerId) {\r\n        return;\r\n      }\r\n      timerId = global.setTimeout(() => {\r\n        setImageSize({\r\n          initW: stateRef.current.imageSize!.initW,\r\n          initH: stateRef.current.imageSize!.initH,\r\n          curW: imageEl.current!.offsetWidth,\r\n          curH: imageEl.current!.offsetHeight\r\n        });\r\n        timerId = undefined;\r\n      }, 200);\r\n    };\r\n\r\n    window.addEventListener('resize', handleResize);\r\n\r\n    return () => window.removeEventListener('resize', handleResize);\r\n  }, []);\r\n\r\n  // Add event handler for all tooltip items\r\n  React.useEffect(() => {\r\n    const startHandler = (event: MouseEvent) => {\r\n      const clicked = event.target as HTMLElement;\r\n      if (clicked.classList.contains('image-tooltips-item__trigger')) {\r\n        const dataIdStr = clicked.parentElement!.getAttribute('data-id');\r\n        if (dataIdStr) {\r\n          const dataId = parseInt(dataIdStr);\r\n          setToggled(stateRef.current.toggled != dataId ? dataId : null);\r\n        } else {\r\n          setToggled(null);\r\n        }\r\n      }\r\n    };\r\n\r\n    const endHandler = () => {\r\n      setToggled(null);\r\n    }\r\n\r\n    divEl.current!.addEventListener(triggerEvent, startHandler);\r\n    if (triggerEvent == 'mouseover') {\r\n      divEl.current!.addEventListener('mouseout', endHandler);\r\n    }\r\n\r\n    return () => {\r\n      divEl.current!.removeEventListener(triggerEvent, startHandler);\r\n      if (triggerEvent == 'mouseover') {\r\n        divEl.current!.removeEventListener('mouseout', endHandler);\r\n      }\r\n    }\r\n  }, []);\r\n\r\n  // Making image responsive\r\n  const style = {\r\n    maxWidth: `${width}px`\r\n  };\r\n\r\n  return (\r\n    <div ref={divEl} className=\"image-tooltips\" style={style}>\r\n      <img ref={imageEl} {...props} onLoad={() => setImageSize({\r\n        // Set initial image dimensions in state\r\n        initW: width,\r\n        initH: height,\r\n        curW: imageEl.current!.offsetWidth,\r\n        curH: imageEl.current!.offsetHeight\r\n      })} />\r\n\r\n      {state.imageSize && children && React.Children.map(children, (child, index) => {\r\n        if (!child || ! React.isValidElement<ImageTooltipsItemProps>(child)) {\r\n          return child;\r\n        }\r\n        const childEl: React.ReactElement<ImageTooltipsItemProps> = child;\r\n\r\n        return (\r\n          <_ImageTooltipsItem\r\n            key={index}\r\n            dataId={index}\r\n            toggled={index === state.toggled}\r\n            imageSize={state.imageSize!}\r\n            {...childEl.props}\r\n          >\r\n            {childEl.props.children}\r\n          </_ImageTooltipsItem>\r\n        );\r\n      })}\r\n    </div>\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"script"}